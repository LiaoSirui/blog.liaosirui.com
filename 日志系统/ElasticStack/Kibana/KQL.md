## KQL

Kibana 查询语法和 Lucene 相同

## KQL 常用

精确搜索完整断句

```kql
"this is my word"
```

如果不带引号，将会匹配每个单词

模糊搜索 `~`

```kql
"/app/~"
"马~"
```

匹配 0 到多个字符 `*`

```kql
"*oken"
"马*"
```

匹配单个字符 `?`

```kql
toke?n
```

`+`，`-` 搜索结果是否包含指定信息

- 注意查询条件和指定信息之间不能有空格直接就是（+/-）连接符。 
- `+`：搜索结果中必须包含词项；
- `-`：不能包含词项

```kql
firstname:(+H* -He*)

# 搜索 firstname 字段里 H 开头的结果，并且排除 firstname 里 He 开头的结果
```

组合查询，运算符必须大写

- AND
- OR
- NOT

```kql
(uid  OR token )  AND version
```

范围查询

- `[]`：包含边界值；
- `{}`：不包含边界值；

```kql
# 查询下面时间范围的日志，包含开始和结束两个时间
["2022-07-14 14:58:43.723" TO "2022-07-14 14:59:43.800"]

# 查询下面时间范围的日志，不包含开始和结束两个时间
{"2022-07-14 14:58:43.723" TO "2022-07-14 14:59:43.800"}
```

特殊字符需要在字符前加上转义字符 `\` ，特殊字符：

```kql
+
-
&&
||
!
( )
{ }
[ ]
^
"
~
*
?
:
\
```

分组查询

```kql
(firstname:H* OR age:20) AND state:KS 

# 先查询名字 H 开头年龄或者是 20 的结果，然后再与国家是 KS 的结合
```

指定从哪个域中寻找查询词，如果不指定，则从默认域中查找

```kql
message:"东电梯"
```

支持使用圆括号来将查询表达式分组

```kql
(Parsed.status:200 Parsed.status:206) AND "mail-online"
 
 
# 查询 status 中含有 200 和 206
Parsed.status:(+200 OR 206)
```

